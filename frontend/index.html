<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green Roots - Construyendo un Futuro Verde</title>
    
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="home.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
<header class="header">
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <img src="Green_Roots.jpg" alt="Green Roots Logo" class="logo-img">
                <h1>Green Roots</h1>
            </div>
            <ul class="nav-menu">
                <li><a href="#inicio" class="nav-link">Inicio</a></li>
                <li><a href="#informacion" class="nav-link">Información</a></li>
                <li><a href="#actividades" class="nav-link">Actividades</a></li>
                <li><a href="#voluntariado" class="nav-link">Voluntariado</a></li>
                <li><a href="#novedades" class="nav-link" id="novedades-link">Novedades</a></li>
            </ul>
            <button id="logoutBtn" class="logout-btn">
                <i class="fas fa-sign-out-alt"></i> Cerrar sesión
            </button>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>
</header>

<main>
    <section id="inicio">...</section>
    <section id="informacion">...</section>
    <section id="actividades">...</section>
    <section id="voluntariado">...</section>
    <section id="novedades">...</section>
    </main>

<footer class="footer">
    </footer>

<script src="home_script.js"></script> 
<script>
    // ✅ 1. REGISTRO DEL SERVICE WORKER (Para PWA y Offline)
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('SW registrado con éxito. Scope:', registration.scope);
          })
          .catch(error => {
            console.log('Fallo al registrar SW:', error);
          });
      });
    }

    // ✅ 2. VERIFICACIÓN DE SESIÓN (Redirección, Límite de 15 segundos)
    const userData = sessionStorage.getItem("usuario");
    const loginPage = "login.html"; // Redirigir al nuevo login

    if (!userData) {
        alert("⚠️ Debes iniciar sesión para acceder a esta página.");
        window.location.href = loginPage; 
    } else {
        const sessionTime = sessionStorage.getItem("sessionTime");
        const now = new Date().getTime();
        
        // 15 SEGUNDOS DE LÍMITE DE SESIÓN
        const FIFTEEN_SECONDS_MS = 15 * 1000; 
        
        if (!sessionTime || now - parseInt(sessionTime) > FIFTEEN_SECONDS_MS) {
            sessionStorage.clear();
            alert("⏰ Tu sesión ha expirado (15 segundos). Por favor inicia sesión nuevamente.");
            window.location.href = loginPage;
        }
    }

    // ✅ 3. CIERRE DE SESIÓN
    document.getElementById("logoutBtn").addEventListener("click", () => {
        sessionStorage.clear();
        alert("Has cerrado sesión correctamente.");
        window.location.href = loginPage;
    });
</script>

</body>
</html>
